[{"assurance_type":"kubernetes","id":8,"name":"k8-sec-pol","description":"","author":"administrator","lastupdate":"2022-01-10T16:32:38.731814Z","cvss_severity_enabled":false,"cvss_severity":"","custom_severity_enabled":false,"custom_severity":"","cvss_severity_exclude_no_fix":false,"maximum_score_enabled":false,"maximum_score":0,"maximum_score_exclude_no_fix":false,"custom_checks_enabled":false,"scap_enabled":false,"cves_black_list_enabled":false,"cves_white_list_enabled":false,"packages_black_list_enabled":false,"packages_white_list_enabled":false,"only_none_root_users":false,"trusted_base_images_enabled":false,"scan_sensitive_data":false,"audit_on_failure":true,"fail_cicd":false,"block_failed":true,"blacklisted_licenses_enabled":false,"blacklisted_licenses":[],"whitelisted_licenses_enabled":false,"whitelisted_licenses":[],"custom_checks":null,"scap_files":null,"scope":{"expression":"v1","variables":[{"attribute":"kubernetes.namespace","value":"apps"}]},"registries":null,"labels":null,"images":null,"cves_black_list":null,"cves_white_list":[""],"packages_black_list":null,"packages_white_list":null,"allowed_images":null,"trusted_base_images":null,"read_only":false,"force_microenforcer":false,"partial_results_image_fail":false,"control_exclude_no_fix":false,"ignore_recently_published_vln":false,"ignore_recently_published_vln_period":0,"ignore_risk_resources_enabled":false,"ignored_risk_resources":[""],"permission":"Write","dta_severity":"","dta_enabled":false,"disallow_malware":null,"monitored_malware_paths":null,"exceptional_monitored_malware_paths":null,"scan_malware_in_archives":false,"malware_action":"","scan_nfs_mounts":false,"required_labels_enabled":false,"required_labels":[],"kubernetes_controls":[{"script_id":38,"name":"Access to host IPC namespace","description":"Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.","enabled":false,"severity":"high","kind":"workload","ootb":true},{"script_id":39,"name":"Access to host PID","description":"Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.","enabled":false,"severity":"high","kind":"workload","ootb":true},{"script_id":40,"name":"Access to host network","description":"Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.","enabled":false,"severity":"high","kind":"workload","ootb":true},{"script_id":75,"name":"Access to host ports","description":"According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.","enabled":false,"severity":"high","kind":"workload","ootb":true},{"script_id":80,"name":"All container images must start with a GCR domain","description":"Containers should only use images from trusted GCR registries.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":79,"name":"All container images must start with an ECR domain","description":"Containers should only use images from trusted registries.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":78,"name":"All container images must start with the *.azurecr.io domain","description":"Containers should only use images from trusted registries.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":35,"name":"CPU not limited","description":"Enforcing CPU limits prevents DoS via resource exhaustion.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":36,"name":"CPU requests not specified","description":"When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":42,"name":"Can elevate its own privileges","description":"A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":44,"name":"ConfigMap with secrets","description":"Storing secrets in configMaps is unsafe","enabled":false,"severity":"high","kind":"configmap","ootb":true},{"script_id":45,"name":"ConfigMap with sensitive content","description":"Storing sensitive content such as usernames and email addresses in configMaps is unsafe","enabled":false,"severity":"medium","kind":"configmap","ootb":true},{"script_id":84,"name":"Container images from public registries used","description":"Container images must not start with an empty prefix or a defined public registry domain.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":47,"name":"Default capabilities: some containers do not drop all","description":"The container should drop all default capabilities and add only those that are needed for its execution.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":81,"name":"Default capabilities: some containers do not drop any","description":"Security best practices require containers to run with minimal required capabilities.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":46,"name":"Delete pod logs","description":"Used to cover attacker’s tracks, but most clusters ship logs quickly off-cluster.","enabled":false,"severity":"medium","kind":"roleandrolebinding","ootb":true},{"script_id":48,"name":"Exec into Pods","description":"The ability to exec into a container with privileged access to the host or with an attached SA with higher RBAC permissions is a common escalation path to cluster-admin.","enabled":false,"severity":"high","kind":"roleandrolebinding","ootb":true},{"script_id":83,"name":"Image tag \":latest\" used","description":"It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":55,"name":"Manage EKS IAM Auth ConfigMap","description":"Ability to add AWS IAM to RBAC bindings via special EKS configmap.","enabled":false,"severity":"critical","kind":"roleandrolebinding","ootb":true},{"script_id":57,"name":"Manage Kubernetes RBAC resources","description":"An effective level of access equivalent to cluster-admin.","enabled":false,"severity":"critical","kind":"roleandrolebinding","ootb":true},{"script_id":56,"name":"Manage Kubernetes networking","description":"The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.","enabled":false,"severity":"high","kind":"roleandrolebinding","ootb":true},{"script_id":58,"name":"Manage Kubernetes workloads and pods","description":"Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.","enabled":false,"severity":"medium","kind":"roleandrolebinding","ootb":true},{"script_id":53,"name":"Manage all resources","description":"Full control of the cluster resources, and therefore also “root” on all nodes where workloads can run and has access to all pods, secrets, and data.","enabled":false,"severity":"critical","kind":"roleandrolebinding","ootb":true},{"script_id":52,"name":"Manage all resources at the namespace","description":"Full control of the resources within a namespace.  In some cluster configurations, this is excessive. In others, this is normal (a gitops deployment operator like flux)","enabled":false,"severity":"high","kind":"roleandrolebinding","ootb":true},{"script_id":54,"name":"Manage configmaps","description":"Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.","enabled":false,"severity":"medium","kind":"roleandrolebinding","ootb":true},{"script_id":59,"name":"Manage namespace secrets","description":"Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.","enabled":false,"severity":"medium","kind":"roleandrolebinding","ootb":true},{"script_id":60,"name":"Manage secrets","description":"Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.","enabled":false,"severity":"critical","kind":"roleandrolebinding","ootb":true},{"script_id":61,"name":"Manage webhookconfigurations","description":"Webhooks can silently intercept or actively mutate/block resources as they are being created or updated. This includes secrets and pod specs.","enabled":false,"severity":"critical","kind":"roleandrolebinding","ootb":true},{"script_id":62,"name":"Manages /etc/hosts","description":"Managing /etc/hosts aliases can prevent the container engine from modifying the file after a pod’s containers have already been started.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":63,"name":"Memory not limited","description":"Enforcing memory limits prevents DoS via resource exhaustion.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":64,"name":"Memory requests not specified","description":"When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":74,"name":"Non-core volume types used.","description":"According to pod security standard 'Volume types', non-core volume types must not be used.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":76,"name":"Non-default /proc masks set","description":"According to pod security standard '/proc Mount Type', the default /proc masks are set up to reduce attack surface, and should be required.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":51,"name":"Privileged","description":"Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.","enabled":true,"severity":"high","kind":"workload","ootb":true},{"script_id":49,"name":"Root file system is not read-only","description":"An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":66,"name":"Runs as root user","description":"Force the running image to run as a non-root user to ensure least privileges.","enabled":true,"severity":"medium","kind":"workload","ootb":true},{"script_id":67,"name":"Runs with GID <= 10000","description":"Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":68,"name":"Runs with UID <= 10000","description":"Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":69,"name":"Runs with a root primary or supplementary GID","description":"According to pod security standard 'Non-root groups', containers should be forbidden from running with a root primary or supplementary GID.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":43,"name":"Runtime/Default AppArmor profile not set","description":"According to pod security standard 'AppArmor', the AppArmor key must be set to the runtime/default profile or to be undefined.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":72,"name":"Runtime/Default Seccomp profile not set","description":"According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.","enabled":false,"severity":"low","kind":"workload","ootb":true},{"script_id":77,"name":"SELinux custom options set","description":"According to pod security standard 'SElinux', setting custom SELinux options should be disallowed.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":37,"name":"SYS_ADMIN capability added","description":"SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.","enabled":false,"severity":"high","kind":"workload","ootb":true},{"script_id":70,"name":"Seccomp policies disabled","description":"A program inside the container can bypass Seccomp protection policies.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":71,"name":"Service with External IP","description":"Services with external IP addresses allows direct access from the internet and might expose risk for CVE-2020-8554","enabled":true,"severity":"high","kind":"service","ootb":true},{"script_id":41,"name":"Specific capabilities added","description":"According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":73,"name":"Unsafe sysctl options set","description":"Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the pod, and is isolated from other pods and processes on the same node.","enabled":false,"severity":"medium","kind":"workload","ootb":true},{"script_id":82,"name":"User with admin access","description":"Either cluster-admin or those granted powerful permissions.","enabled":false,"severity":"critical","kind":"roleandrolebinding","ootb":true},{"script_id":65,"name":"hostPath volume mounted with docker.sock","description":"Mounting docker.sock from the host can give the container full root access to the host.","enabled":false,"severity":"high","kind":"workload","ootb":true},{"script_id":50,"name":"hostPath volumes mounted","description":"According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.","enabled":false,"severity":"medium","kind":"workload","ootb":true}],"forbidden_labels_enabled":false,"forbidden_labels":[],"scan_windows_registry":false,"scan_process_memory":false,"application_scopes":["Global"],"docker_cis_enabled":false,"kube_cis_enabled":false,"enforce_excessive_permissions":false,"blacklist_permissions_enabled":false,"blacklist_permissions":null,"linux_cis_enabled":false,"openshift_hardening_enabled":false,"function_integrity_enabled":false,"auto_scan_enabled":false,"auto_scan_configured":false}]